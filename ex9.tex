\documentclass{llncs}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{gensymb}
\usepackage{epstopdf}
\usepackage{hyperref}
\usepackage{circus}

\begin{document}
\begin{schema}{State}
var1 : \power \{1,2,3\}\\
var2 : \{a1:\nat; a2:\nat | a1 \neq a2 @ (a1,a2)\}
\end{schema}
\begin{schema}{Op}
\Delta State
\where
var2' = \emptyset
\end{schema}


\begin{circus}
\circchannel store, add, out : NAT\\
\circchannel result, reset\\
\end{circus}
\begin{circus}
\circprocess Register \circdef\\
	\circbegin \circstate RegSt \defs [ value : NAT]\\
	A2 \circdef A \linter NSa | NSb \rinter B\\
	A3 \circdef (c \then A \lpar ns1 | \lchanset c \rchanset | ns2 \rpar c \then Skip)\\
	A4 \circdef (c.e \then A \lpar ns1 | \lchanset c \rchanset | ns2 \rpar c.e \then Skip)\\
	% A2 \circdef \lpar CS \rpar x: T \circspot A\\
	% A2 \circdef \Intchoice x : T \circspot A\\
	% A2 \circdef \Extchoice x : T \circspot A\\
	% A2 \circdef \Semi x : T \circspot A\\
	% A2 \circdef (x : T \circspot A)\\
	% A2 \circdef (\circval x : T \circspot A)\\
	% A2 \circdef (\circres x : T \circspot A)\\
	% A2 \circdef (\circvres x : T \circspot A)\\
	% A2 \circdef (x : T \circspot A)(v)\\
	% A2 \circdef (\circval x : T \circspot A)(v)\\
	% A2 \circdef (\circres x : T \circspot A)(v)\\
	% A2 \circdef (\circvres x : T \circspot A)(v)\\
	% A2 \circdef (\circmu X \circspot x : T \circspot A)(v)\\
	% A2 \circdef (\circmu X \circspot (x : T \circspot A))(v)\\
	% A2 \circdef (\circmu X \circspot \circval x : T \circspot A)(v)\\
	% A2 \circdef (\circmu X \circspot \circres x : T \circspot A)(v)\\
	% A2 \circdef (\circmu X \circspot \circvres x : T \circspot A)(v)\\
	% A2 \circdef (A \circhide CS)\\
	\circspot (value := 0) \\
	\circend\\
\end{circus}
\begin{circus}
\circprocess VaA \circdef\\
	\circbegin \circstate RegSt \defs [ value : NAT]\\
	A2 \circdef a : T; y :YY \circspot \Skip
	\circspot (\circvar x : T \circspot MA) \\
	\circend\\
\end{circus}
\begin{circus}
\circprocess VaB \circdef\\
	\circbegin \circstate RegSt \defs [ value : NAT] \land [x : T]\\
	A2 \circdef \Skip
	\circspot MA \\
	\circend\\
\end{circus}
\begin{circus}
\circprocess VaC \circdef\\
	\circbegin
	A2 \circdef a : T; y :YY \circspot \Skip
	\circspot (\circvar x : T \circspot MA) \\
	\circend\\
\end{circus}
\begin{circus}
\circprocess VaD \circdef\\
	\circbegin \circstate RegSt \defs [x : T]\\
	A2 \circdef \Skip
	\circspot MA \\
	\circend\\
\end{circus}
\begin{circus}
\circchannel read, write : Z\\
\circprocess SumClient \circdef\\
	\circbegin\\
	ReadValue \circdef read?n \then reset \then Sum(n)\\
	Sum \circdef n : NAT \circspot \lcircguard n = 0 \rcircguard \circguard result \then out?r \then write!r \then \Skip\\
	\extchoice \lcircguard n \neq 0 \rcircguard \circguard add!n \then Sum(n)\\
\circspot \Skip\\
	\circend\\
\end{circus}
\begin{circus}
\circchannelset RegAlphabet == \lchanset store, add, out, result, reset \rchanset\\
%\circprocess Summation \circdef ( SumClient \lpar RegAlphabet \rpar Register ) \circhide RegAlphabet
\end{circus}
\end{document}
